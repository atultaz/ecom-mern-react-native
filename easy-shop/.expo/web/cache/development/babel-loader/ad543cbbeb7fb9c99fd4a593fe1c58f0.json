{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useCallback } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport { Container, Header, Icon, Item, Input, Text } from \"native-base\";\nimport { useFocusEffect } from '@react-navigation/native';\nimport baseUrl from \"../../assets/common/baseUrl\";\nimport axios from 'axios';\nimport ProductList from \"./ProductList\";\nimport SearchedProduct from \"./SearchedProducts\";\nimport Banner from \"../../Shared/Banner\";\nimport CategoryFilter from \"./CategoryFilter\";\nimport baseURL from \"../../assets/common/baseUrl\";\n\nvar _Dimensions$get = Dimensions.get('window'),\n    height = _Dimensions$get.height;\n\nvar ProductContainer = function ProductContainer(props) {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      products = _useState2[0],\n      setProducts = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      productsFiltered = _useState4[0],\n      setProductsFiltered = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      focus = _useState6[0],\n      setFocus = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      categories = _useState8[0],\n      setCategories = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      productsCtg = _useState10[0],\n      setProductsCtg = _useState10[1];\n\n  var _useState11 = useState(),\n      _useState12 = _slicedToArray(_useState11, 2),\n      active = _useState12[0],\n      setActive = _useState12[1];\n\n  var _useState13 = useState([]),\n      _useState14 = _slicedToArray(_useState13, 2),\n      initialState = _useState14[0],\n      setInitialState = _useState14[1];\n\n  var _useState15 = useState(true),\n      _useState16 = _slicedToArray(_useState15, 2),\n      loading = _useState16[0],\n      setLoading = _useState16[1];\n\n  useFocusEffect(useCallback(function () {\n    setFocus(false);\n    setActive(-1);\n    axios.get(baseURL + \"products\").then(function (res) {\n      setProducts(res.data);\n      setProductsFiltered(res.data);\n      setProductsCtg(res.data);\n      setInitialState(res.data);\n      setLoading(false);\n    }).catch(function (error) {\n      console.log('Api call error');\n    });\n    axios.get(baseURL + \"categories\").then(function (res) {\n      setCategories(res.data);\n    }).catch(function (error) {\n      console.log('Api call error');\n    });\n    return function () {\n      setProducts([]);\n      setProductsFiltered([]);\n      setFocus();\n      setCategories([]);\n      setActive();\n      setInitialState();\n    };\n  }, []));\n\n  var searchProduct = function searchProduct(text) {\n    setProductsFiltered(products.filter(function (i) {\n      return i.name.toLowerCase().includes(text.toLowerCase());\n    }));\n  };\n\n  var openList = function openList() {\n    setFocus(true);\n  };\n\n  var onBlur = function onBlur() {\n    setFocus(false);\n  };\n\n  var changeCtg = function changeCtg(ctg) {\n    {\n      ctg === \"all\" ? [setProductsCtg(initialState), setActive(true)] : [setProductsCtg(products.filter(function (i) {\n        return i.category._id === ctg;\n      }), setActive(true))];\n    }\n  };\n\n  return React.createElement(React.Fragment, null, loading == false ? React.createElement(Container, null, React.createElement(Header, {\n    searchBar: true,\n    rounded: true\n  }, React.createElement(Item, null, React.createElement(Icon, {\n    name: \"ios-search\"\n  }), React.createElement(Input, {\n    placeholder: \"Search\",\n    onFocus: openList,\n    onChangeText: function onChangeText(text) {\n      return searchProduct(text);\n    }\n  }), focus == true ? React.createElement(Icon, {\n    onPress: onBlur,\n    name: \"ios-close\"\n  }) : null)), focus == true ? React.createElement(SearchedProduct, {\n    navigation: props.navigation,\n    productsFiltered: productsFiltered\n  }) : React.createElement(ScrollView, null, React.createElement(View, null, React.createElement(View, null, React.createElement(Banner, null)), React.createElement(View, null, React.createElement(CategoryFilter, {\n    categories: categories,\n    categoryFilter: changeCtg,\n    productsCtg: productsCtg,\n    active: active,\n    setActive: setActive\n  })), productsCtg.length > 0 ? React.createElement(View, {\n    style: styles.listContainer\n  }, productsCtg.map(function (item) {\n    return React.createElement(ProductList, {\n      navigation: props.navigation,\n      key: item.name,\n      item: item\n    });\n  })) : React.createElement(View, {\n    style: [styles.center, {\n      height: height / 2\n    }]\n  }, React.createElement(Text, null, \"No products found\"))))) : React.createElement(Container, {\n    style: [styles.center, {\n      backgroundColor: \"#f2f2f2\"\n    }]\n  }, React.createElement(ActivityIndicator, {\n    size: \"large\",\n    color: \"red\"\n  })));\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    flexWrap: \"wrap\",\n    backgroundColor: \"gainsboro\"\n  },\n  listContainer: {\n    height: height,\n    flex: 1,\n    flexDirection: \"row\",\n    alignItems: \"flex-start\",\n    flexWrap: \"wrap\",\n    backgroundColor: \"gainsboro\"\n  },\n  center: {\n    justifyContent: 'center',\n    alignItems: 'center'\n  }\n});\nexport default ProductContainer;","map":{"version":3,"sources":["/Users/atultiwari/Desktop/mern-ecom-app/easy-shop/Screens/Products/ProductContainer.js"],"names":["React","useState","useCallback","Container","Header","Icon","Item","Input","Text","useFocusEffect","baseUrl","axios","ProductList","SearchedProduct","Banner","CategoryFilter","baseURL","Dimensions","get","height","ProductContainer","props","products","setProducts","productsFiltered","setProductsFiltered","focus","setFocus","categories","setCategories","productsCtg","setProductsCtg","active","setActive","initialState","setInitialState","loading","setLoading","then","res","data","catch","error","console","log","searchProduct","text","filter","i","name","toLowerCase","includes","openList","onBlur","changeCtg","ctg","category","_id","navigation","length","styles","listContainer","map","item","center","backgroundColor","StyleSheet","create","container","flexWrap","flex","flexDirection","alignItems","justifyContent"],"mappings":"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","sourcesContent":["import React, { useState, useCallback } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  ActivityIndicator,\n  FlatList,\n  ScrollView,\n  Dimensions\n} from \"react-native\";\nimport { Container, Header, Icon, Item, Input, Text } from \"native-base\";\nimport { useFocusEffect } from '@react-navigation/native'\nimport baseUrl from \"../../assets/common/baseUrl\"\nimport axios from 'axios';\n\nimport ProductList from \"./ProductList\";\nimport SearchedProduct from \"./SearchedProducts\";\nimport Banner from \"../../Shared/Banner\";\nimport CategoryFilter from \"./CategoryFilter\";\nimport baseURL from \"../../assets/common/baseUrl\";\n\nvar { height } = Dimensions.get('window')\n\nconst ProductContainer = (props) => {\n  const [products, setProducts] = useState([]);\n  const [productsFiltered, setProductsFiltered] = useState([]);\n  const [focus, setFocus] = useState();\n  const [categories, setCategories] = useState([]);\n  const [productsCtg, setProductsCtg] = useState([]);\n  const [active, setActive] = useState();\n  const [initialState, setInitialState] = useState([]);\n  const [loading, setLoading] = useState(true)\n\n  useFocusEffect((\n    useCallback(\n      () => {\n        setFocus(false);\n        setActive(-1);\n        \n        // Products\n        axios\n          .get(`${baseURL}products`)\n          .then((res) => {\n            setProducts(res.data);\n            setProductsFiltered(res.data);\n            setProductsCtg(res.data);\n            setInitialState(res.data);\n            setLoading(false)\n          })\n          .catch((error) => {\n            console.log('Api call error')\n          })\n    \n        // Categories\n        axios\n          .get(`${baseURL}categories`)\n          .then((res) => {\n            setCategories(res.data)\n          })\n          .catch((error) => {\n            console.log('Api call error')\n          })\n    \n        return () => {\n          setProducts([]);\n          setProductsFiltered([]);\n          setFocus();\n          setCategories([]);\n          setActive();\n          setInitialState();\n        };\n      },\n      [],\n    )\n  ))\n    \n   \n  \n\n  // Product Methods\n  const searchProduct = (text) => {\n    setProductsFiltered(\n      products.filter((i) => i.name.toLowerCase().includes(text.toLowerCase()))\n    );\n  };\n\n  const openList = () => {\n    setFocus(true);\n  };\n\n  const onBlur = () => {\n    setFocus(false);\n  };\n\n  // Categories\n  const changeCtg = (ctg) => {\n    {\n      ctg === \"all\"\n        ? [setProductsCtg(initialState), setActive(true)]\n        : [\n            setProductsCtg(\n              products.filter((i) => i.category._id === ctg),\n              setActive(true)\n            ),\n          ];\n    }\n  };\n\n  return (\n    <>\n    {loading == false ? (\n <Container>\n <Header searchBar rounded>\n   <Item>\n     <Icon name=\"ios-search\" />\n     <Input\n       placeholder=\"Search\"\n       onFocus={openList}\n       onChangeText={(text) => searchProduct(text)}\n     />\n     {focus == true ? <Icon onPress={onBlur} name=\"ios-close\" /> : null}\n   </Item>\n </Header>\n {focus == true ? (\n   <SearchedProduct \n   navigation={props.navigation}\n   productsFiltered={productsFiltered} />\n ) : (\n   <ScrollView>\n     <View>\n       <View>\n         <Banner />\n       </View>\n       <View>\n         <CategoryFilter\n           categories={categories}\n           categoryFilter={changeCtg}\n           productsCtg={productsCtg}\n           active={active}\n           setActive={setActive}\n         />\n       </View>\n       {productsCtg.length > 0 ? (\n       <View style={styles.listContainer}>\n           {productsCtg.map((item) => {\n               return(\n                   <ProductList\n                       navigation={props.navigation}\n                       key={item.name}\n                       item={item}\n                   />\n               )\n           })}\n       </View>\n       ) : (\n           <View style={[styles.center, { height: height / 2}]}>\n               <Text>No products found</Text>\n           </View>\n       )}\n      \n     </View>\n   </ScrollView>\n )}\n</Container>\n    ) : (\n      // Loading\n      <Container style={[styles.center, { backgroundColor: \"#f2f2f2\" }]}>\n        <ActivityIndicator size=\"large\" color=\"red\" />\n      </Container>\n    )}\n   </>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flexWrap: \"wrap\",\n    backgroundColor: \"gainsboro\",\n  },\n  listContainer: {\n    height: height,\n    flex: 1,\n    flexDirection: \"row\",\n    alignItems: \"flex-start\",\n    flexWrap: \"wrap\",\n    backgroundColor: \"gainsboro\",\n  },\n  center: {\n      justifyContent: 'center',\n      alignItems: 'center'\n  }\n});\n\nexport default ProductContainer;\n"]},"metadata":{},"sourceType":"module"}